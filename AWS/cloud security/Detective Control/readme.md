### DETECTIVE CONTROL
========================
Question to the class, How do you discover if something goes wrong in your environment in your absent?

In order to detect compromise in your AWS Account, you need to see every resources in your AWS Account as OBSERVABLE OBJECT. These observable objects and the information they manage, process, analyze, transmit or archive are the goal of your protection.

To protect the resources in your AWS Account using detective control means, you need to gather information about the status of the resources and most importantly the events or how the resources state are changing.

### AWS Detective control flow(DCF)
==============================
Let's look at the AWS Detective control flow. The DCF have hour part. 
a. The Resources State
b. Event Collection
c. Event Analysis
d. Action

# 1.  The Resources State
The DCF starts with keeping track of the configuration and the status over time of the collection of resources in your AWS Account. The collections of the resources(resources state) are the object under observations. They can be AWS resources such as EC2 Instances, S3 Buckets and objects, Amazon RDS , Amazon API Gateway etc or external or third party resources. 

# 2.  Event Collection
The Resources state change overtime as a result of business use or change in the environment or period of time. These changes or action represent an event. As event can occur at any point in time, day, night  or weekend, they need to be gathered or collected and this is called Event record or observable record.The Event collection is the registering or collecting or gathering of the events that occur as a result of the change in the 

# 3. Event Analysis
Event gathered  or collected from the change in the resource state are raw, cumbersome and in large amount thus challenging to read or use. Thus, the raw data should be analysis to provide valuable  or value-added information. These analysis can be done in various ways such as compare the event with best practice, or baseline and inform you if there is a different between current state or desire state. You can also use statistic to determine if the event is normal or not.

### 4. Action 
Analyzing the event collected from changes in resources that not complete if there is no response to the observable record or action to remediate the security issue or changes that was detected. Thus, the final state of the detective control is action taken. 

AWS provide multiple service or resources for every state of the detective control. In the next few hours we are going to be looking at some of these tools for each stage.

### 1.  RESOURCES STATE TOOLS
=========================
The first state, resources state, focus on knowing the state of the monitored resources. AWS Config and AWS System Manager, are two of the AWS Tools that helps to monitored the changes in the state of the observable object.

## AWS Config
Every AWS resources in your account have their configuration(enable, disable or customer configuration) at each point in time. AWS Config provides a detailed view of the configuration of AWS resources in your AWS account.

### 2. EVENT COLLECTION
=============================
### A.  AWS CLOUDTRAIL
 All action on AWS is an API Call. The API Calls. AWS CloudTrail is one of the services that keep record of these calls. CloudTrail also keep records of Non-API events that relate to service actions and sign-in attempt to the AWS Console.

 The activities that is recorded in the cloudtrail is called an event. There are three type of events:
 #     a. Management Event:
        Logs of Operation perform on an AWS Resources such as Create Bucket, delete bucket, create user, create group and Non API event like Log-in and Attempt Log-In.

 #    b. Data Event: 
         Logs of Operation perform within an AWS Resources such as Uploading an Image in S# Bucket(PutObject), Delete an Image from a Bucket(deleteObject) or GetObject which is view an image or list image from a bucket.
 #      c. Insight: 
        Meta-data events generated by CloudTrail when it detect an unusual or anomalies activities 

### B. CLOUDWATCH
        Amazon CloudWatch monitors your Amazon Web Services (AWS) resources and the applications you run on AWS in real time. You can use CloudWatch to collect and track metrics, which are variables you can measure for your resources and applications.

## FEATURES OF CLOUDTRAIL
- Metrics
- Logs
- Alarm 
- Events

# METRICS
       Metrics are data about the performance of your resources or application on those resources which allows you to assess and understand how the application performs under various circumstances. Situations like heavy traffic, heavy computation, intense processing, etc., test our application and its limits. AWS resources such as Amazon EC2 instances, Amazon EBS volumes, and Amazon RDS DB instances can generate metrics for cloudwatch.Metric data is kept for 15 months, enabling you to view both up-to-the-minute data and historical data
       Example of a metric is CPUUtilization of an EC2

# CloudWatch provides two categories of monitoring: basic monitoring and detailed monitoring.
==============================================================================================

  #      BASIC MONITORING: 
                Many AWS services offer basic monitoring by publishing a default set of metrics to CloudWatch with no charge to customers. By default, when you start using one of these AWS services, basic monitoring is automatically enabled. Example of the service is EC2 Instance
   #     DETAILED MONITORING:
                Detailed monitoring is offered by only some services. It also incurs charges. To use it for an AWS service, you must choose to activate it. Detailed monitoring deferred base on Resources. For Some resources, detailed monitoring means gathering and reporting metrics to cloudwatch more frequently. published at one-minute intervals, instead of the five-minute intervals used in Amazon EC2 basic monitoring while on other like S3 it means more fine-grained metrics.
                In different AWS services, detailed monitoring also has different names. For example, in Amazon EC2 it is called detailed monitoring, in AWS Elastic Beanstalk it is called enhanced monitoring, and in Amazon S3 it is called request metrics.

                For more information about monitoring visit https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/cloudwatch-metrics-basic-detailed.html


# NAME SPACES
    A namespaces is a container for CloudWatch metrics. It helps you to isolate metrics from different AWS resources and also to ensure that metrics from different application are not aggregated together. Example of a namespaces are AWS/EC2, AWS/Billing, AWS/RDS etc

# ALARM
        You can use an alarm to automatically initiate actions on your behalf.  An alarm watches a single metric over a specified time period, and performs one or more specified actions, based on the value of the metric relative to a threshold over time. The action is a notification sent to an Amazon SNS topic or an Auto Scaling policy. You can also add alarms to dashboards.

### AMAZON CLOUDWATCH FEATURES
===============================

1. Collect
      Collect logs and store logs thus serves as a repository
2. Monitor
        Monitor application using the dashboard provided
3. Act 
        Cloudwatch logs can response to system events or performance with automated response
4. Analyze
        Operation on metrics and log analytics
5. Integrate with other AWS Service or resources such as AWS SNS or IAM



### C. AMAZON HEALTH
        Provides you with information about issues, notification  or scheduled changes in the underlying infrastructure.This information is uncover in Amazon Health Dashboard in the AWS Management console.

        In this dashboard, you will find the most recent issues and notifications and the upcoming scheduled changes. It provide event logs for events within the last 90 days.


### STAGE 3: EVENT ANALYSIS
## 1. Amazon Inspector
                Amazon Inspector is an automated security assessment service that helps improve the security and compliance of applications deployed on AWS. Amazon Inspector automatically assesses applications for exposure, vulnerabilities, and deviations from best practices.
Amazon EC2 scanning
To provide common vulnerabilities and exposures (CVE) data for your EC2 instance, Amazon Inspector requires that the AWS Systems Manager (SSM) agent be installed and enabled

## 2. Amazon Guardduty

        3. Security Hub
        4. AWS Trusted Advisor
        5. AWS System Manager- State Manager, Patch Manager and Compliance



